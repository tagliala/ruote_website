<!DOCTYPE html>
<html><head>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<title>ruote - concurrence expression</title>
<script src='/js/shCore.js'></script>
<script src='/js/shBrushXml.js'></script>
<script src='/js/shBrushBash.js'></script>
<script src='/js/shBrushRuby.js'></script>
<script src='/js/shBrushJScript.js'></script>
<!-- %script{ :src => "/js/jquery-1.6.1.min.js" } -->
<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js'></script>
<link href='/css/reset.css' rel='stylesheet' type='text/css'>
<link href='/css/shCore.css' rel='stylesheet' type='text/css'>
<link href='/css/shThemeRuote.css' rel='stylesheet' type='text/css'>
<link href='/css/ruote.css' rel='stylesheet' type='text/css'>
</head><body>
<div id='container'>
<div id='header'>
<div id='header-center'>
<div id='header-left'>
<a href='/'>
<img src='/images/ruote.png'>
</a>
<div id='header-subtitle'>
a ruby workflow engine
</div>
</div>
<div id='header-right'>
<div id='nav'>
<span>
<a href='/documentation.html' title='documentation'>
doc
</a>
<a href='/source.html' title='source code'>
source
</a>
<a href='/download.html' title='download'>
download
</a>
<a class='nihongo' href='/ja.html' title='日本語'>
日本語
</a>
</span>
</div>
</div>
</div>
</div>
<div id='content'>
<div id='content-center'>
<div id='sidebar'><h3 onclick='document.location = &quot;/documentation.html&quot;' style='cursor: pointer'>
Documentation
</h3>
<ul>
<li>
<a href='/ruote_website/exp/add_branches.html'>
add_branches expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/add_branches.html'>
add_branches
</a>
</li>
<li>
<a href='/ruote_website/exp/add_branches.html'>
add_branch
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/apply.html'>
apply expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/apply.html'>
apply
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/await.html'>
await expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/await.html'>
await
</a>
</li>
</ul>
<li>
<a href='/ruote_website/part/block_participant.html'>
block_participant
</a>
</li>
<li>
<a href='/ruote_website/exp/cancel_process.html'>
cancel_process expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/cancel_process.html'>
cancel_process
</a>
</li>
<li>
<a href='/ruote_website/exp/cancel_process.html'>
terminate
</a>
</li>
<li>
<a href='/ruote_website/exp/cancel_process.html'>
kill_process
</a>
</li>
</ul>
<li>
<a href='/ruote_website/part/code_participant.html'>
code_participant
</a>
</li>
<li>
<a href='/ruote_website/exp/command.html'>
command expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/command.html'>
skip
</a>
</li>
<li>
<a href='/ruote_website/exp/command.html'>
back
</a>
</li>
<li>
<a href='/ruote_website/exp/command.html'>
jump
</a>
</li>
<li>
<a href='/ruote_website/exp/command.html'>
rewind
</a>
</li>
<li>
<a href='/ruote_website/exp/command.html'>
continue
</a>
</li>
<li>
<a href='/ruote_website/exp/command.html'>
break
</a>
</li>
<li>
<a href='/ruote_website/exp/command.html'>
stop
</a>
</li>
<li>
<a href='/ruote_website/exp/command.html'>
over
</a>
</li>
<li>
<a href='/ruote_website/exp/command.html'>
reset
</a>
</li>
</ul>
<li>
<a href='/ruote_website/common_attributes.html'>
common attributes
</a>
</li>
<li class='current'>
<a href='/ruote_website/exp/concurrence.html'>
concurrence expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/concurrence.html'>
concurrence
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/concurrent_iterator.html'>
concurrent_iterator expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/concurrent_iterator.html'>
concurrent_iterator
</a>
</li>
<li>
<a href='/ruote_website/exp/concurrent_iterator.html'>
citerator
</a>
</li>
</ul>
<li>
<a href='/ruote_website/conditions.html'>
conditions
</a>
</li>
<li>
<a href='/ruote_website/configuration.html'>
configuration
</a>
</li>
<li>
<a href='/ruote_website/exp/cron.html'>
cron expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/cron.html'>
cron
</a>
</li>
<li>
<a href='/ruote_website/exp/cron.html'>
every
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/cursor.html'>
cursor expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/cursor.html'>
cursor
</a>
</li>
<li>
<a href='/ruote_website/exp/cursor.html'>
loop
</a>
</li>
<li>
<a href='/ruote_website/exp/cursor.html'>
repeat
</a>
</li>
</ul>
<li>
<a href='/ruote_website/part/decision_participant.html'>
decision_participant
</a>
</li>
<li>
<a href='/ruote_website/exp/define.html'>
define expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/define.html'>
define
</a>
</li>
<li>
<a href='/ruote_website/exp/define.html'>
process_definition
</a>
</li>
<li>
<a href='/ruote_website/exp/define.html'>
workflow_definition
</a>
</li>
</ul>
<li>
<a href='/ruote_website/documentation.html'>
documentation
</a>
</li>
<li>
<a href='/ruote_website/dollar.html'>
dollar notation
</a>
</li>
<li>
<a href='/ruote_website/download.html'>
download
</a>
</li>
<li>
<a href='/ruote_website/exp/echo.html'>
echo expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/echo.html'>
echo
</a>
</li>
</ul>
<li>
<a href='/ruote_website/part/engine_participant.html'>
engine_participant
</a>
</li>
<li>
<a href='/ruote_website/exp/equals.html'>
equals expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/equals.html'>
equals
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/error.html'>
error expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/error.html'>
error
</a>
</li>
</ul>
<li>
<a href='/ruote_website/expressions.html'>
expressions
</a>
</li>
<li>
<a href='/ruote_website/exp/filter.html'>
filter expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/filter.html'>
filter
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/forget.html'>
forget expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/forget.html'>
forget
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/given.html'>
given expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/given.html'>
given
</a>
</li>
</ul>
<li>
<a href='/ruote_website/glossary.html'>
glossary
</a>
</li>
<li>
<a href='/ruote_website/exp/if.html'>
if expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/if.html'>
if
</a>
</li>
</ul>
<li>
<a href='/ruote_website/implementing_a_storage.html'>
implementing a storage
</a>
</li>
<li>
<a href='/ruote_website/implementing_participants.html'>
implementing participants
</a>
</li>
<li>
<a href='/ruote_website/exp/inc.html'>
inc expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/inc.html'>
inc
</a>
</li>
<li>
<a href='/ruote_website/exp/inc.html'>
dec
</a>
</li>
<li>
<a href='/ruote_website/exp/inc.html'>
increment
</a>
</li>
<li>
<a href='/ruote_website/exp/inc.html'>
decrement
</a>
</li>
<li>
<a href='/ruote_website/exp/inc.html'>
push
</a>
</li>
<li>
<a href='/ruote_website/exp/inc.html'>
pop
</a>
</li>
</ul>
<li>
<a href='/ruote_website.html'>
index
</a>
</li>
<li>
<a href='/ruote_website/exp/iterator.html'>
iterator expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/iterator.html'>
iterator
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/let.html'>
let expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/let.html'>
let
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/listen.html'>
listen expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/listen.html'>
listen
</a>
</li>
<li>
<a href='/ruote_website/exp/listen.html'>
receive
</a>
</li>
<li>
<a href='/ruote_website/exp/listen.html'>
intercept
</a>
</li>
</ul>
<li>
<a href='/ruote_website/lists.html'>
lists
</a>
</li>
<li>
<a href='/ruote_website/part/local_participant.html'>
local_participant
</a>
</li>
<li>
<a href='/ruote_website/exp/lose.html'>
lose expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/lose.html'>
lose
</a>
</li>
</ul>
<li>
<a href='/ruote_website/part/no_op_participant.html'>
no_op_participant
</a>
</li>
<li>
<a href='/ruote_website/noisy.html'>
noisy output
</a>
</li>
<li>
<a href='/ruote_website/exp/noop.html'>
noop expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/noop.html'>
noop
</a>
</li>
</ul>
<li>
<a href='/ruote_website/part/null_participant.html'>
null_participant
</a>
</li>
<li>
<a href='/ruote_website/exp/on_error.html'>
on_error expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/on_error.html'>
on_error
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/once.html'>
once expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/once.html'>
once
</a>
</li>
<li>
<a href='/ruote_website/exp/once.html'>
when
</a>
</li>
<li>
<a href='/ruote_website/exp/once.html'>
as_soon_as
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/participant.html'>
participant expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/participant.html'>
participant
</a>
</li>
</ul>
<li>
<a href='/ruote_website/part_implementations.html'>
participant implementations
</a>
</li>
<li>
<a href='/ruote_website/presentations.html'>
presentations
</a>
</li>
<li>
<a href='/ruote_website/process_administration.html'>
process administration
</a>
</li>
<li>
<a href='/ruote_website/definitions.html'>
process definitions
</a>
</li>
<li>
<a href='/ruote_website/process_observation.html'>
process observation
</a>
</li>
<li>
<a href='/ruote_website/participants.html'>
process participants
</a>
</li>
<li>
<a href='/ruote_website/exp/read.html'>
read expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/read.html'>
read
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/redo.html'>
redo expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/redo.html'>
redo
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/ref.html'>
ref expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/ref.html'>
ref
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/registerp.html'>
registerp expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/registerp.html'>
registerp
</a>
</li>
</ul>
<li>
<a href='/ruote_website/rel.html'>
rel values for ruote-http / ruote-kit links
</a>
</li>
<li>
<a href='/ruote_website/exp/reserve.html'>
reserve expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/reserve.html'>
reserve
</a>
</li>
</ul>
<li>
<a href='/ruote_website/resources.html'>
resources
</a>
</li>
<li>
<a href='/ruote_website/exp/restore.html'>
restore expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/restore.html'>
restore
</a>
</li>
<li>
<a href='/ruote_website/exp/restore.html'>
set_fields
</a>
</li>
</ul>
<li>
<a href='/ruote_website/part/rev_participant.html'>
rev_participant
</a>
</li>
<li>
<a href='/ruote_website/users.html'>
ruote users
</a>
</li>
<li>
<a href='/ruote_website/sample_workflow_run.html'>
sample workflow run
</a>
</li>
<li>
<a href='/ruote_website/exp/save.html'>
save expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/save.html'>
save
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/sequence.html'>
sequence expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/sequence.html'>
sequence
</a>
</li>
<li>
<a href='/ruote_website/exp/sequence.html'>
let
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/set.html'>
set expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/set.html'>
rset
</a>
</li>
<li>
<a href='/ruote_website/exp/set.html'>
set
</a>
</li>
<li>
<a href='/ruote_website/exp/set.html'>
unset
</a>
</li>
</ul>
<li>
<a href='/ruote_website/part/smtp_participant.html'>
smtp_participant
</a>
</li>
<li>
<a href='/ruote_website/source.html'>
source
</a>
</li>
<li>
<a href='/ruote_website/exp/stall.html'>
stall expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/stall.html'>
stall
</a>
</li>
</ul>
<li>
<a href='/ruote_website/part/storage_participant.html'>
storage_participant
</a>
</li>
<li>
<a href='/ruote_website/exp/subprocess.html'>
subprocess expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/subprocess.html'>
subprocess
</a>
</li>
</ul>
<li>
<a href='/ruote_website/testing_participants.html'>
testing participants
</a>
</li>
<li>
<a href='/ruote_website/testing_processes.html'>
testing processes
</a>
</li>
<li>
<a href='/ruote_website/exp/that.html'>
that expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/that.html'>
that
</a>
</li>
<li>
<a href='/ruote_website/exp/that.html'>
of
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/undo.html'>
undo expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/undo.html'>
undo
</a>
</li>
<li>
<a href='/ruote_website/exp/undo.html'>
cancel
</a>
</li>
<li>
<a href='/ruote_website/exp/undo.html'>
kill
</a>
</li>
</ul>
<li>
<a href='/ruote_website/exp/unregisterp.html'>
unregisterp expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/unregisterp.html'>
unregisterp
</a>
</li>
</ul>
<li>
<a href='/ruote_website/vars_and_fields.html'>
variables and fields
</a>
</li>
<li>
<a href='/ruote_website/exp/wait.html'>
wait expression
</a>
</li>
<ul class='alias'>
<li>
<a href='/ruote_website/exp/wait.html'>
wait
</a>
</li>
<li>
<a href='/ruote_website/exp/wait.html'>
sleep
</a>
</li>
</ul>
<li>
<a href='/ruote_website/with_rails.html'>
with rails
</a>
</li>
<li>
<a href='/ruote_website/patterns.html'>
workflow control patterns
</a>
</li>
<li>
<a href='/ruote_website/ja.html'>
日本語
</a>
</li>
</ul>
<h3>
More
</h3>
<ul class='contact'>
<li>
<a href='https://github.com/jmettraux/ruote/tree/master/quickstart'>
quickstart
</a>
</li>
<li>
<a href='/presentations.html'>
presentations
</a>
</li>
<li>
<a href='/resources.html'>
resources
</a>
</li>
<li>
<a href='/users.html'>
users
</a>
</li>
</ul>
<h3>
Meta
</h3>
<ul class='contact'>
<li>
<a href='/source.html'>
source
</a>
</li>
<li>
<a href='/download.html'>
download
</a>
</li>
<li>
<a href='http://jmettraux.github.com'>
blog
</a>
</li>
<li>
<a href='/lists.html'>
mailing list
</a>
</li>
<li>
<a href='http://ruote-ci.s3.amazonaws.com/ci.html'>
continuous integration
</a>
</li>
<li>
<a href='http://ruote-irclogs.s3.amazonaws.com/logs.html'>
IRC
</a>
</li>
<li>
<a href='https://www.ohloh.net/p/ruote/'>
on ohloh
</a>
</li>
</ul>
<h3>
<span>
Search
</span>
</h3>
<ul class='contact'>
<li>
<form action='http://www.google.com/search' method='GET'>
<input id='qq' name='qq' style='' type='text'>
<input id='q' name='q' type='hidden'>
<input onclick='adjustSearch();' type='submit' value='search'>
</form>
</li>
</ul>
<script>
  function adjustSearch() {
    $('#q').val($('#qq').val() + ' site:http://ruote.rubyforge.org');
  }
</script>
</div>
<div id='content-main'>
<h2>concurrence</h2>
<p>The &#8216;concurrence&#8217; expression applies its child branches in parallel<br />
(well it makes a best effort to make them run in parallel).</p>
<pre class="brush: ruby">
  concurrence do
    alpha
    bravo
  end
</pre>
<h3>attributes</h3>
<p>The concurrence expression takes a number of attributes that allow for<br />
sophisticated control (especially at merge time).</p>
<h4>:count</h4>
<pre class="brush: ruby">
  concurrence :count =&gt; 1 do
    alpha
    bravo
  end
</pre>
<p>in that example, the concurrence will terminate as soon as 1 (count) of<br />
the branches replies. The other branch will get cancelled.</p>
<p>:count and :wait_for may point to a negative integer, meaning &#8220;all but<br />
x&#8221;.</p>
<pre class="brush: ruby">
  concurrence :count =&gt; -2 do # all the branches replied but 2
    # ...
  end
</pre>
<p>:count can be shortened to :c.</p>
<h4>:wait_for</h4>
<p>This attribute accepts either an integer, either a list of tags.</p>
<p>When used with the integer, it&#8217;s equivalent to the :count attribute:</p>
<pre class="brush: ruby">
  concurrence :wait_for =&gt; 1 do
    # ...
  end
</pre>
<p>It waits for 1 branch to respond and then moves on (concurrence over).</p>
<p>When used with a string (or an array), it extracts a list of tags and waits<br />
for the branches with those tags. Once all the tags have replied,<br />
the concurrence is over.</p>
<pre class="brush: ruby">
  concurrence :wait_for =&gt; 'alpha, bravo' do
    sequence :tag =&gt; 'alpha' do
      # ...
    end
    sequence :tag =&gt; 'bravo' do
      # ...
    end
    sequence :tag =&gt; 'charly' do
      # ...
    end
  end
</pre>
<p>This concurrence will be over when the branches alpha and bravo have<br />
replied. The charly branch may have replied or not, it doesn&#8217;t matter.</p>
<p>:wait_for can be shortened to :wf.</p>
<h4>:over_if (and :over_unless) attribute</h4>
<p>Like the :count attribute controls how many branches have to reply before<br />
a concurrence ends, the :over attribute is used to specify a condition<br />
upon which the concurrence will [prematurely] end.</p>
<pre class="brush: ruby">
  concurrence :over_if =&gt; '${f:over}'
    alpha
    bravo
    charly
  end
</pre>
<p>will end the concurrence as soon as one of the branches replies with a<br />
workitem whose field &#8216;over&#8217; is set to true. (the remaining branches will<br />
get cancelled unless :remaining =&gt; :forget is set).</p>
<p>:over_unless needs no explanation.</p>
<h4>:remaining</h4>
<p>As said for :count, the remaining branches get cancelled. By setting<br />
:remaining to :forget (or &#8216;forget&#8217;), the remaining branches will continue<br />
their execution, forgotten.</p>
<pre class="brush: ruby">
  concurrence :count =&gt; 1, :remaining =&gt; :forget do
    alpha
    bravo
  end
</pre>
<p>:remaining can be shortened to :rem or :r.</p>
<p>The default is &#8216;cancel&#8217;, where all the remaining branches are cancelled<br />
while the hand is given back to the main flow.</p>
<p>There is a third setting, &#8216;wait&#8217;. It behaves like &#8216;cancel&#8217;, but the<br />
concurrence waits for the cancelled children to reply. The workitems<br />
from cancelled branches are merged in as well.</p>
<h4>:merge</h4>
<p>By default, the workitems override each others. By default, the first<br />
workitem to reply will win.</p>
<pre class="brush: ruby">
  sequence do
    concurrence do
      alpha
      bravo
    end
    charly
  end
</pre>
<p>In that example, if &#8216;alpha&#8217; replied first, the workitem that reaches<br />
&#8216;charly&#8217; once &#8216;bravo&#8217; replied will have the payload as seen/modified by<br />
&#8216;alpha&#8217;.</p>
<p>The :merge attribute determines which branch wins the merge.</p>
<ul>
	<li>first (default)</li>
	<li>last</li>
	<li>highest</li>
	<li>lowest</li>
</ul>
<p>highest and lowest refer to the position in the list of branch. It&#8217;s useful<br />
to set a fixed winner.</p>
<pre class="brush: ruby">
  concurrence :merge =&gt; :highest do
    alpha
    bravo
  end
</pre>
<p>makes sure that alpha&#8217;s version of the workitem wins.</p>
<p>:merge can be shortened to :m.</p>
<h4>:merge_type</h4>
<h5>:merge_type =&gt; :override (default)</h5>
<p>By default, the merge type is set to &#8216;override&#8217;, which means that the<br />
&#8216;winning&#8217; workitem&#8217;s payload supplants all other workitems&#8217; payloads.</p>
<h5>:merge_type =&gt; :mix</h5>
<p>Setting :merge_type to :mix, will actually attempt to merge field by field,<br />
making sure that the field value of the winner(s) are used.</p>
<h5>:merge_type =&gt; :isolate</h5>
<p>:isolate will rearrange the resulting workitem payload so that there is<br />
a new field for each branch. The name of each field is the index of the<br />
branch from &#8216;0&#8217; to &#8230;</p>
<h5>:merge_type =&gt; :stack</h5>
<p>:stack will stack the workitems coming back from the concurrence branches<br />
in an array whose order is determined by the :merge attributes. The array<br />
is placed in the &#8216;stack&#8217; field of the resulting workitem.<br />
Note that the :stack merge_type also creates a &#8216;stack_attributes&#8217; field<br />
and populates it with the expanded attributes of the concurrence.</p>
<p>Thus</p>
<pre class="brush: ruby">
  sequence do
    concurrence :merge =&gt; :highest, :merge_type =&gt; :stack do
      reviewer1
      reviewer2
    end
    editor
  end
</pre>
<p>will see the &#8216;editor&#8217; receive a workitem whose fields look like :</p>
<pre class="brush: ruby">
  { 'stack' =&gt; [{ ... reviewer1 fields ... }, { ... reviewer2 fields ... }],
    'stack_attributes' =&gt; { 'merge'=&gt; 'highest', 'merge_type' =&gt; 'stack' } }
</pre>
<p>This could prove useful for participant having to deal with multiple merge<br />
strategy results.</p>
<h5>:merge_type =&gt; :union</h5>
<p>(Available from ruote 2.3.0)</p>
<p>Will override atomic fields, concat arrays and merge hashes&#8230;</p>
<p>The union of those two workitems</p>
<pre class="brush: ruby">
  { 'a' =&gt; 0, 'b' =&gt; [ 'x', 'y' ], 'c' =&gt; { 'aa' =&gt; 'bb' }
  { 'a' =&gt; 1, 'b' =&gt; [ 'y', 'z' ], 'c' =&gt; { 'cc' =&gt; 'dd' }
</pre>
<p>will be</p>
<pre class="brush: ruby">
  { 'a' =&gt; 1,
    'b' =&gt; [ 'x', 'y', 'z' ],
    'c' =&gt; { 'aa' =&gt; 'bb', 'cc' =&gt; 'dd' } }
</pre>
<p>Warning: duplicates in arrays present <em>before</em> the merge will be removed<br />
as well.</p>
<h5>:merge_type =&gt; :concat</h5>
<p>(Available from ruote 2.3.0)</p>
<p>Much like :union, but duplicates are not removed. Thus</p>
<pre class="brush: ruby">
  { 'a' =&gt; 0, 'b' =&gt; [ 'x', 'y' ], 'c' =&gt; { 'aa' =&gt; 'bb' }
  { 'a' =&gt; 1, 'b' =&gt; [ 'y', 'z' ], 'c' =&gt; { 'cc' =&gt; 'dd' }
</pre>
<p>will be</p>
<pre class="brush: ruby">
  { 'a' =&gt; 1,
    'b' =&gt; [ 'x', 'y', 'y', 'z' ],
    'c' =&gt; { 'aa' =&gt; 'bb', 'cc' =&gt; 'dd' } }
</pre>
<h5>:merge_type =&gt; :deep</h5>
<p>(Available from ruote 2.3.0)</p>
<p>Identical to :concat but hashes are merged with deep_merge (ActiveSupport<br />
flavour).</p>
<h5>:merge_type =&gt; :ignore</h5>
<p>(Available from ruote 2.3.0)</p>
<p>A very simple merge type, the workitems given back by the branches are<br />
simply discarded and the workitem as passed to the concurrence expression<br />
is used to reply to the parent expression (of the concurrence expression).</p>
<p>:merge_type can be shortened to :mt.</p>
</div>
</div>
</div>
</div>
<div id='footer'>
<div id='footer-center'>
<p>
<span id='footer-left'>
<a href='https://github.com/jmettraux/ruote_website/issues'>doc issue reporting</a>
|
<a href='https://github.com/jmettraux/ruote_website'>doc source</a>
| created with
<a href='http://nanoc.stoneship.org'>nanoc</a>
and
<a href='http://alexgorbatchev.com/SyntaxHighlighter/'>syntax highlighter</a>
</span>
<span id='footer-right'>
&copy; 2005-2013 the ruote team
</span>
</p>
</div>
</div>
<script>
  SyntaxHighlighter.all();
  
  if (location.hostname != 'localhost' && location.hostname != '127.0.0.1') {
  
    // gauges
  
    var _gauges = _gauges || [];
    (function() {
      var t   = document.createElement('script');
      t.type  = 'text/javascript';
      t.async = true;
      t.id    = 'gauges-tracker';
      t.setAttribute('data-site-id', '50454d13f5a1f57e4200001b');
      t.src = '//secure.gaug.es/track.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(t, s);
    })();
  
    // ga
  
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-138748-2']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
    })();
  }
</script>
</body>
</html>
